#!/bin/sh

# Tell server to shut down.
/home/jyates/repos/rtags/bin/rc --quit-rdm
if [ -e ~/.rdm ] ; then
    echo pausing
    sleep 5
fi
rm -f ${HOME}/.rdm* >/dev/null

#  --help|-h                                  Display this page.
#  --include-path|-I [arg]                    Add additional include path to clang.
#  --include|-i [arg]                         Add additional include directive to clang.
#  --define|-D [arg]                          Add additional define directive to clang.
#  --log-file|-L [arg]                        Log to this file.
#  --append|-A                                Append to log file.
#  --verbose|-v                               Change verbosity, multiple -v's are allowed.
#  --clear-project-caches|-C                  Clear out project caches.
#  --enable-sighandler|-s                     Enable signal handler to dump stack for crashes..
#                                             Note that this might not play well with clang's signal handler.
#  --clang-includepath|-P                     Use clang include paths by default.
#  --no-Wall|-W                               Don't use -Wall.
#  --Wlarge-by-value-copy|-r [arg]            Use -Wlarge-by-value-copy=[arg] when invoking clang.
#  --no-spell-checking|-l                     Don't pass -fspell-checking.
#  --unlimited-error|-f                       Pass -ferror-limit=0 to clang.
#  --silent|-S                                No logging to stdout.
#  --validate|-V                              Enable validation of database on startup and after indexing.
#  --exclude-filter|-x [arg]                  Files to exclude from rdm, default "*/CMakeFiles/*;*/cmake*/Modules/*;*/conftest.c*;/tmp/*".
#  --no-rc|-N                                 Don't load any rc files.
#  --ignore-printf-fixits|-F                  Disregard any clang fixit that looks like it's trying to fix format for printf and friends.
#  --config|-c [arg]                         Use this file instead of ~/.rdmrc.
#  --data-dir|-d [arg]                        Use this directory to store persistent data (default ~/.rtags).
#  --socket-file|-n [arg]                     Use this file for the server socket (default ~/.rdm).
#  --setenv|-e [arg]                          Set this environment variable (--setenv "foobar=1").
#  --completion-cache-size|-a [arg]           Cache this many translation units (default 0, must have at least 1 to use completion).
#  --no-current-project|-o                    Don't restore the last current project on startup.
#  --allow-multiple-builds|-m                 Without this setting different builds will be merged for each source file.
#  --unload-timer|-u [arg]                    Number of minutes to wait before unloading non-current projects (disabled by default).
#  --thread-count|-j [arg]                    Spawn this many threads for thread pool.
#  --watch-system-paths|-w                    Watch system paths for changes.
#  --clear-completion-cache-interval|-O [arg] Set completion cache cleanup interval in minuts. (default 60)
#  --no-filemanager-watch|-M                  Don't use a file system watcher for filemanager.
#  --ignore-compiler|-b [arg]                 Alias this compiler (Might be practical to avoid duplicated builds for things like icecc).
#  --disable-plugin|-p [arg]                  Don't load this plugin
#  --disable-esprima|-E                       Don't use esprima
#  --enable-compiler-flags|-K                 Query the compiler for default flags
#

/home/jyates/repos/rtags/bin/rdm --validate \
    --log-file /dev/null \
    --silent \
    --data-dir ${HOME}/.rtags \
    --validate \
    --enable-compiler-flags \
    --include-path /usr/include \
    --include-path /usr/include/c++/4.7 \
    --unlimited-error \
    --ignore-printf-fixits \
    --completion-cache-size 1000 \
    --allow-multiple-builds \
    --unload-timer 60 \
    --thread-count 15 \
    --watch-system-paths \
    --disable-esprima \
    &

