#!/bin/dash

set -e

if [ ! -f "src/bitmaps/st.info" ]; then
   echo "Working directory ( $(pwd) ) is not the root of an st source tree."; exit 1
fi

make clean
git pull
make clean

wget http://st.suckless.org/patches/st-no-bold-colors.diff
git apply st-no-bold-colors.diff
rm -r st-no-bold-colors.diff

wget http://st.suckless.org/patches/st-solarized-dark.diff
cp config.def.h config.h
git apply st-solarized-dark.diff
rm -f st-solarized-dark.diff

CFLAGS='-march=corei7 -O3' make

